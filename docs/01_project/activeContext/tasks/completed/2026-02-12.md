# 2026年02月12日 完了タスク

最終更新日: 2026年02月12日

## Community Nodes / `cn-cli` Node Key + Access Control 統合テスト

- [x] `cn-cli` の `node-key generate/rotate/show` 統合テストを追加し、監査ログ記録とCLI出力互換を検証
- [x] `cn-cli` の `access-control rotate/revoke` 統合テストを追加し、監査ログ・DB反映・CLI出力互換を検証
- [x] `cn-cli` 実装に `access_control.rotate` / `access_control.revoke` の監査ログ記録を追加
- [x] `community_nodes_roadmap.md` の該当未実装項目を完了へ更新
- [x] 進捗レポート `docs/01_project/progressReports/2026-02-12_cn_cli_access_control_node_key_integration_tests.md` を作成

## 検証

- [x] `./scripts/test-docker.ps1 rust -NoBuild`（成功）
  - `tmp/logs/test-docker-rust-cn-cli-access-control-20260211-235253.log`
- [x] `gh act --workflows .github/workflows/test.yml --job format-check`
  - 初回失敗（`rustfmt` 差分）: `tmp/logs/gh-act-format-check-cn-cli-access-control-20260211-235325.log`
  - `cargo fmt --all` 後の再実行成功: `tmp/logs/gh-act-format-check-cn-cli-access-control-20260211-235448.log`
- [x] `gh act --workflows .github/workflows/test.yml --job native-test-linux`（成功）
  - `tmp/logs/gh-act-native-test-linux-cn-cli-access-control-20260211-235608.log`
- [x] `gh act --workflows .github/workflows/test.yml --job community-node-tests`（成功）
  - `tmp/logs/gh-act-community-node-tests-cn-cli-access-control-20260212-000304.log`

## Community Nodes / Access Control 再配布結果の記録・参照（success/failed/pending + reason）

- [x] `cn-core` に再配布結果記録を追加し、epoch rotate/revoke で `pending -> success|failed` と `reason` を保存できるようにした
- [x] `cn-admin-api` に再配布結果 API（`GET /v1/admin/access-control/distribution-results`）を追加し、rotate/revoke レスポンスへ `distribution_results` を追加した
- [x] Admin Console（Access Control）に再配布結果の可視化（集計 + failed/pending 一覧 + 検索）を追加した
- [x] DB マイグレーション `kukuri-community-node/migrations/20260211000000_access_control_distribution_results.sql` を追加した
- [x] `community_nodes_roadmap.md` の該当未実装項目2件を完了（`[x]`）へ更新した
- [x] 進捗レポート `docs/01_project/progressReports/2026-02-12_access_control_distribution_results.md` を作成した

## 検証（Access Control 再配布結果）

- [x] `./scripts/test-docker.ps1 rust -NoBuild`（ログ上成功）
  - `tmp/logs/test-docker-rust-access-control-distribution-20260212-035553.log`
- [x] `./scripts/test-docker.ps1 ts -NoBuild`（ログ上成功）
  - `tmp/logs/test-docker-ts-access-control-distribution-20260212-035613.log`
- [x] `docker run --rm -v ${PWD}:/workspace -w /workspace/kukuri-community-node/apps/admin-console -e CI=true node:20-bookworm bash -lc "corepack enable && pnpm install --frozen-lockfile && pnpm test -- src/pages/AccessControlPage.test.tsx"`（成功）
  - `tmp/logs/docker-admin-console-access-control-page-20260212-040903.log`
- [x] `gh act --workflows .github/workflows/test.yml --job format-check`（成功）
  - `tmp/logs/gh-act-format-check-access-control-distribution-20260212-035709.log`
- [x] `gh act --workflows .github/workflows/test.yml --job native-test-linux`（成功）
  - `tmp/logs/gh-act-native-test-linux-access-control-distribution-20260212-035828.log`
- [x] `gh act --workflows .github/workflows/test.yml --job community-node-tests`（成功）
  - `tmp/logs/gh-act-community-node-tests-access-control-distribution-20260212-040450.log`
