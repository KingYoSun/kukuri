# 2025年10月30日 完了タスク

- [x] NIPs 準拠イベントスキーマ（NIP-01/10/19/30078 等）の検証/テスト方針を実装へ反映  
  - `Event::validate_for_gateway` を導入し、NIP-10/19/kind30078 の厳密検証と PRE スキーマチェックを実装。  
  - `ValidationFailureKind` を全レイヤへ展開し、P2P メトリクス（`receive_failures_by_reason`）と Offline `SyncStatus::Invalid` で理由を共有。  
  - `nostr_event_validation.md` / `phase5_test_inventory.md` を更新し、方針・テストの実装状況を最新化。
- [x] EventManager 結合テストを `tests/integration/event/manager` に追加し、`./scripts/test-docker.ps1 rust -Test <target>` で個別テストを実行可能に整備  
  - `event_manager_integration` を新設し、P2P 経由のイベント永続化（ハンドラー）とオフラインモードでのトピック配信を検証するシナリオを追加。  
  - `scripts/test-docker.ps1` に `-Test` オプションを実装し、PowerShell から任意の Rust テストバイナリを指定実行できるようにした。  
  - `phase5_test_inventory.md` / `phase5_ci_path_audit.md` / `p2p_mainline_runbook.md` を更新し、CI/Runbook のテスト手順を `event_manager_integration` に追随。

## 検証
- `cd kukuri-tauri/src-tauri && cargo fmt && cargo test`
