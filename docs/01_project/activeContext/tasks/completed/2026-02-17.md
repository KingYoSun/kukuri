# 2026年02月17日 完了タスク

最終更新日: 2026年02月17日

## Issue #52 Desktop E2E failure 修正（Run `22075452530` / Job `63789452806`）

- [x] `gh api repos/KingYoSun/kukuri/actions/jobs/63789452806/logs` で失敗ログを解析し、`Run community node E2E scenario` 失敗の内訳（`community-node.friend-plus` / `community-node.invite` / `direct-messages.inbox` / `sync.offline-status`）を特定。
- [x] Desktop E2E の不安定要因を最小差分で修正（i18n 依存セレクタの多言語対応、トピック遷移待機強化、`create-post-button` の test id 追加、同期キュー更新ボタンの `aria-label` 対応）。
- [x] 進捗レポート `docs/01_project/progressReports/2026-02-17_issue52_desktop_e2e_fix.md` を追加。

## 検証

- [x] `DOCKER_CONFIG=/tmp/.docker bash scripts/test-docker.sh e2e-community-node`（初回: `Spec Files: 16 passed, 1 failed`。失敗は `sync.offline-status.spec.ts` の「再送キュー更新ボタンが見つかりませんでした」）
- [x] `DOCKER_CONFIG=/tmp/.docker bash scripts/test-docker.sh e2e-community-node`（修正後再実行: `Spec Files: 17 passed, 17 total`）
- [x] `NPM_CONFIG_PREFIX=/tmp/npm-global XDG_CACHE_HOME=/tmp/xdg-cache DOCKER_CONFIG=/tmp/docker-config gh act --workflows .github/workflows/test.yml --job format-check`（pass, ログ: `tmp/logs/gh-act-format-check-issue52.log`）
- [x] `NPM_CONFIG_PREFIX=/tmp/npm-global XDG_CACHE_HOME=/tmp/xdg-cache DOCKER_CONFIG=/tmp/docker-config gh act --workflows .github/workflows/test.yml --job native-test-linux`（pass, ログ: `tmp/logs/gh-act-native-test-linux-issue52.log`）
- [x] `NPM_CONFIG_PREFIX=/tmp/npm-global XDG_CACHE_HOME=/tmp/xdg-cache DOCKER_CONFIG=/tmp/docker-config gh act --workflows .github/workflows/test.yml --job community-node-tests`（pass, ログ: `tmp/logs/gh-act-community-node-tests-issue52.log`）

## Issue #52 PR #54 レビュー指摘対応（`discussion_r2815371993`）

- [x] `kukuri-tauri/tests/e2e/specs/community-node.friend-plus.spec.ts` のトピック遷移で `topicId` を `encodeURIComponent` して `pushState` / `location.replace` に反映。
- [x] 遷移確認 `waitUntil` もエンコード後URL（`/topics/${encodedTopicId}`）を基準に統一し、`/`・`?` を含む `topicId` でも経路が壊れないよう修正。
- [x] `pnpm exec eslint tests/e2e/specs/community-node.friend-plus.spec.ts`（pass）
- [x] `pnpm exec prettier --check tests/e2e/specs/community-node.friend-plus.spec.ts`（初回 fail → `pnpm exec prettier --write ...` 実施後 pass）
- [x] `NPM_CONFIG_PREFIX=/tmp/npm-global XDG_CACHE_HOME=/tmp/xdg-cache DOCKER_CONFIG=/tmp/docker-config gh act --workflows .github/workflows/test.yml --job format-check`（pass, ログ: `tmp/logs/gh-act-format-check-issue52-review-followup.log`）
- [x] `NPM_CONFIG_PREFIX=/tmp/npm-global XDG_CACHE_HOME=/tmp/xdg-cache DOCKER_CONFIG=/tmp/docker-config gh act --workflows .github/workflows/test.yml --job native-test-linux`（pass, ログ: `tmp/logs/gh-act-native-test-linux-issue52-review-followup.log`）
- [x] `NPM_CONFIG_PREFIX=/tmp/npm-global XDG_CACHE_HOME=/tmp/xdg-cache DOCKER_CONFIG=/tmp/docker-config gh act --workflows .github/workflows/test.yml --job community-node-tests`（pass, ログ: `tmp/logs/gh-act-community-node-tests-issue52-review-followup.log`）
