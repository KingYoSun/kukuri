# メトリクス更新ログ 2025年10月

## 2025年10月20日
- 実施者: Codex（CI）
- 実行内容:
  - `pnpm install --frozen-lockfile`
  - `pnpm test` / `pnpm exec vitest run --reporter=json`
  - `pnpm lint`（失敗）
  - `cargo test`（失敗）
  - `cargo clippy -- -D warnings`
  - `rg` による TODO / `any` / `#[allow(dead_code)]` カウント
- 結果概要:
  - TypeScript テスト: 694件中 688件成功 / 6件スキップ（`2025-10-20-vitest-results.json` に保存）。
  - Lint: `src/stores/draftStore.test.ts` の未使用変数で失敗。
  - Rust テスト: Windows DLL 依存により `STATUS_ENTRYPOINT_NOT_FOUND` で失敗（Docker 経由が必要）。
  - Clippy: 成功。
  - TODO/any 集計: TS TODO 1件 / `any` 94件、Rust TODO 21件 / `#[allow(dead_code)]` 20件。
- ギャップ/アクションアイテム:
  - Vitest v3 では `--filter` オプションが利用できない。フローのコマンド記載を修正。
  - Windows で Rust テストを実行する際は Docker 使用を必須と明記。
  - Lint 失敗箇所の修正が必要（`localStorageMock` → `_localStorageMock` 等）。
  - `rg` 集計の再現性確保のため、スクリプト化と対象ディレクトリ/グロブの固定が必要。
  - `scripts/run-rust-tests.ps1` を追加し、Docker 経由での Rust テスト実行を自動化（初回実行時に Docker Hub へのアクセスが必要）。

## 2025年10月21日
- 実施者: Codex
- 実行内容:
  - `pnpm lint` を再実行し、`src/stores/draftStore.test.ts` の未使用変数修正を確認。
  - `scripts/metrics/collect-metrics.{ps1,sh}` を追加。PowerShell 版で計測し、成果物を `docs/01_project/activeContext/artefacts/metrics/2025-10-21-collect-metrics.json` に保存。
  - `build_status.md`・`code_quality.md`・`test_results.md`・`update_flow.md` を最新状態へ反映。
- 結果概要:
  - TypeScript Lint: 成功。ESLint エラー 0件を確認。
  - TODO/any 集計: TypeScript TODO 1件 / `any` 94件、Rust TODO 21件 / `#[allow(dead_code)]` 20件（`2025-10-21-collect-metrics.json`）。
  - Rust テスト: 引き続き Docker 経由での実行が必要（`scripts/run-rust-tests.ps1`）。
- フォローアップ:
  - `collect-metrics` スクリプトに未使用API・未使用インポート計測とカバレッジ抽出を追加。
  - Rust テストを Docker 経由で実行し、結果を次回ログへ記録。
  - 定期実行フローに PowerShell/Bash 版 `collect-metrics` の出力取り込みを組み込む。
